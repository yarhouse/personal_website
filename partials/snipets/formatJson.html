<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  1</span> .factory(<span style="color: #4070a0">&#39;FormatJSON&#39;</span>, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  2</span>   [ <span style="color: #4070a0">&#39;$filter&#39;</span>, <span style="color: #4070a0">&#39;$timeout&#39;</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  3</span>   <span style="color: #007020; font-weight: bold">function</span> ($filter, $timeout) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  4</span>     <span style="color: #007020; font-weight: bold">return</span> {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  5</span>       config<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>(dataobject, time_end, options) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  6</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  7</span>         <span style="color: #007020; font-weight: bold">var</span> availability <span style="color: #666666">=</span> dataobject; 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  8</span>         <span style="color: #007020; font-weight: bold">var</span> company <span style="color: #666666">=</span> availability.company;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">  9</span>         <span style="color: #007020; font-weight: bold">var</span> numberofrows <span style="color: #666666">=</span> company.totalseries;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 10</span>         <span style="color: #007020; font-weight: bold">var</span> companyID <span style="color: #666666">=</span> company.id;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 11</span>         <span style="color: #007020; font-weight: bold">var</span> series <span style="color: #666666">=</span> company.series;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 12</span>         <span style="color: #007020; font-weight: bold">var</span> allPercentages <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">new</span> <span style="color: #007020">Array</span>();
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 13</span>         <span style="color: #007020; font-weight: bold">var</span> chartdata <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">new</span> <span style="color: #007020">Array</span>();
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 14</span>         <span style="color: #007020; font-weight: bold">var</span> each_unmapped_time <span style="color: #666666">=</span> <span style="color: #007020">Array</span>.apply(<span style="color: #007020; font-weight: bold">null</span>, <span style="color: #007020; font-weight: bold">new</span> <span style="color: #007020">Array</span>(numberofrows)).map(<span style="color: #007020">Number</span>.prototype.valueOf, <span style="color: #40a070">0</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 15</span>         <span style="color: #007020; font-weight: bold">var</span> new_end_time <span style="color: #666666">=</span> <span style="color: #007020">Array</span>.apply(<span style="color: #007020; font-weight: bold">null</span>, <span style="color: #007020; font-weight: bold">new</span> <span style="color: #007020">Array</span>(numberofrows)).map(<span style="color: #007020">Number</span>.prototype.valueOf, time_end);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 16</span>         <span style="color: #007020; font-weight: bold">var</span> totalUpTime <span style="color: #666666">=</span> <span style="color: #007020">Array</span>.apply(<span style="color: #007020; font-weight: bold">null</span>, <span style="color: #007020; font-weight: bold">new</span> <span style="color: #007020">Array</span>(numberofrows)).map(<span style="color: #007020">Number</span>.prototype.valueOf, <span style="color: #40a070">0</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 17</span>         <span style="color: #007020; font-weight: bold">var</span> totalDownTime <span style="color: #666666">=</span> <span style="color: #007020">Array</span>.apply(<span style="color: #007020; font-weight: bold">null</span>, <span style="color: #007020; font-weight: bold">new</span> <span style="color: #007020">Array</span>(numberofrows)).map(<span style="color: #007020">Number</span>.prototype.valueOf, <span style="color: #40a070">0</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 18</span>         <span style="color: #007020; font-weight: bold">var</span> totalMaintTime <span style="color: #666666">=</span> <span style="color: #007020">Array</span>.apply(<span style="color: #007020; font-weight: bold">null</span>, <span style="color: #007020; font-weight: bold">new</span> <span style="color: #007020">Array</span>(numberofrows)).map(<span style="color: #007020">Number</span>.prototype.valueOf, <span style="color: #40a070">0</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 19</span>         <span style="color: #007020; font-weight: bold">var</span> topThreePercents <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">new</span> <span style="color: #007020">Array</span>();
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 20</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 21</span>         <span style="color: #60a0b0; font-style: italic">// =====================================================================================================</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 22</span>         <span style="color: #60a0b0; font-style: italic">// Creates the formated object for Highcharts columnrange chart. Done. You have a timeline.</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 23</span>         <span style="color: #007020; font-weight: bold">for</span> (<span style="color: #007020; font-weight: bold">var</span> i <span style="color: #666666">=</span> <span style="color: #40a070">0</span>; i <span style="color: #666666">&lt;</span> series.length; i<span style="color: #666666">++</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 24</span>           <span style="color: #007020; font-weight: bold">if</span> (series[i].name <span style="color: #666666">===</span> <span style="color: #4070a0">&#39;Available&#39;</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 25</span>             
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 26</span>             <span style="color: #007020; font-weight: bold">var</span> upHash <span style="color: #666666">=</span> {<span style="color: #4070a0">&quot;name&quot;</span><span style="color: #666666">:</span>series[i].name, <span style="color: #60a0b0; font-style: italic">// Put Available as series name</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 27</span>                           <span style="color: #4070a0">&quot;data&quot;</span><span style="color: #666666">:</span> series[i].data, <span style="color: #60a0b0; font-style: italic">// The range point data from ICIS to be read by Highcharts</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 28</span>                           <span style="color: #4070a0">&quot;color&quot;</span><span style="color: #666666">:</span> options.availgreen.color, <span style="color: #60a0b0; font-style: italic">// Color variable</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 29</span>                           <span style="color: #4070a0">&quot;pointWidth&quot;</span><span style="color: #666666">:</span> options.serverWidth}; <span style="color: #60a0b0; font-style: italic">// Variable for width/thickness of range points</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 30</span>             <span style="color: #007020; font-weight: bold">var</span> upDataLength <span style="color: #666666">=</span> series[i].data.length; <span style="color: #60a0b0; font-style: italic">// Count how many individual range points for entire Available series</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 31</span>             chartdata.push(upHash);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 32</span>           } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (series[i].name <span style="color: #666666">===</span> <span style="color: #4070a0">&#39;Unavailable&#39;</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 33</span>             
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 34</span>             <span style="color: #007020; font-weight: bold">var</span> downHash <span style="color: #666666">=</span> {<span style="color: #4070a0">&quot;name&quot;</span><span style="color: #666666">:</span>series[i].name, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 35</span>                             <span style="color: #4070a0">&quot;data&quot;</span><span style="color: #666666">:</span> series[i].data, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 36</span>                             <span style="color: #4070a0">&quot;color&quot;</span><span style="color: #666666">:</span> options.unavailred.color, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 37</span>                             <span style="color: #4070a0">&quot;pointWidth&quot;</span><span style="color: #666666">:</span> options.serverWidth};
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 38</span>             <span style="color: #007020; font-weight: bold">var</span> downDataLength <span style="color: #666666">=</span> series[i].data.length;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 39</span>             chartdata.push(downHash);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 40</span>           } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (series[i].name <span style="color: #666666">===</span> <span style="color: #4070a0">&#39;Maintenance&#39;</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 41</span>             
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 42</span>             <span style="color: #007020; font-weight: bold">var</span> maintHash <span style="color: #666666">=</span> {<span style="color: #4070a0">&quot;name&quot;</span><span style="color: #666666">:</span>series[i].name, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 43</span>                             <span style="color: #4070a0">&quot;data&quot;</span><span style="color: #666666">:</span> series[i].data, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 44</span>                             <span style="color: #4070a0">&quot;color&quot;</span><span style="color: #666666">:</span> options.maintyellow.color, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 45</span>                             <span style="color: #4070a0">&quot;pointWidth&quot;</span><span style="color: #666666">:</span> (options.serverWidth <span style="color: #666666">/</span> <span style="color: #40a070">2.5</span>)};
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 46</span>             <span style="color: #007020; font-weight: bold">var</span> maintDataLength <span style="color: #666666">=</span> series[i].data.length;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 47</span>             chartdata.push(maintHash);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 48</span>           } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (series[i].name <span style="color: #666666">===</span> <span style="color: #4070a0">&#39;Unmapped&#39;</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 49</span>             
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 50</span>             <span style="color: #60a0b0; font-style: italic">// if the unmapped data is less than 60 seconds (one minute) total time, </span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 51</span>             <span style="color: #60a0b0; font-style: italic">// splice it from the array before pushing to the series</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 52</span>             <span style="color: #60a0b0; font-style: italic">// for (var d = series[i].data.length - 1; d &gt;= 0; d--) {</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 53</span>             <span style="color: #60a0b0; font-style: italic">//   if (series[i].data[d].high - series[i].data[d].low &lt; 60000 ) {</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 54</span>             <span style="color: #60a0b0; font-style: italic">//     series[i].data.splice(d, 1);</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 55</span>             <span style="color: #60a0b0; font-style: italic">//   };</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 56</span>             <span style="color: #60a0b0; font-style: italic">// };</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 57</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 58</span>             <span style="color: #007020; font-weight: bold">var</span> unmappedHash <span style="color: #666666">=</span> {<span style="color: #4070a0">&quot;name&quot;</span><span style="color: #666666">:</span>options.unmapped.name, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 59</span>                                 <span style="color: #4070a0">&quot;data&quot;</span><span style="color: #666666">:</span> series[i].data, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 60</span>                                 <span style="color: #4070a0">&quot;color&quot;</span><span style="color: #666666">:</span> options.unmapped.color, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 61</span>                                 <span style="color: #4070a0">&quot;pointWidth&quot;</span><span style="color: #666666">:</span> options.serverWidth, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 62</span>                                 <span style="color: #60a0b0; font-style: italic">// &quot;enableMouseTracking&quot;: false, </span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 63</span>                                 showInLegend<span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>};
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 64</span>             <span style="color: #007020; font-weight: bold">var</span> unmappedDataLength <span style="color: #666666">=</span> series[i].data.length;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 65</span>             chartdata.push(unmappedHash);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 66</span>           } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (series[i].name <span style="color: #666666">===</span> <span style="color: #4070a0">&#39;Unregistered&#39;</span>) { 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 67</span>             
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 68</span>             <span style="color: #007020; font-weight: bold">var</span> unregstdHash <span style="color: #666666">=</span> {<span style="color: #4070a0">&quot;name&quot;</span><span style="color: #666666">:</span>options.unregstd.name, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 69</span>                                 <span style="color: #4070a0">&quot;data&quot;</span><span style="color: #666666">:</span> series[i].data, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 70</span>                                 <span style="color: #4070a0">&quot;color&quot;</span><span style="color: #666666">:</span> options.unregstd.color,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 71</span>                                 <span style="color: #4070a0">&quot;pointWidth&quot;</span><span style="color: #666666">:</span> options.serverWidth,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 72</span>                                 <span style="color: #60a0b0; font-style: italic">// &quot;borderColor&quot;: &quot;#333&quot;,</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 73</span>                                 <span style="color: #60a0b0; font-style: italic">// &quot;borderWidth&quot;: &quot;2&quot;,</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 74</span>                                 <span style="color: #60a0b0; font-style: italic">// &quot;enableMouseTracking&quot;: false, </span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 75</span>                                 showInLegend<span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>};
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 76</span>             <span style="color: #007020; font-weight: bold">var</span> unregstdDataLength <span style="color: #666666">=</span> series[i].data.length;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 77</span>             chartdata.push(unregstdHash);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 78</span>           } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (series[i].name <span style="color: #666666">===</span> <span style="color: #4070a0">&#39;No Availability&#39;</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 79</span>             
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 80</span>             <span style="color: #007020; font-weight: bold">var</span> notconfigHash <span style="color: #666666">=</span> {<span style="color: #4070a0">&quot;name&quot;</span><span style="color: #666666">:</span>options.notconfig.name, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 81</span>                                 <span style="color: #4070a0">&quot;data&quot;</span><span style="color: #666666">:</span> series[i].data, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 82</span>                                 <span style="color: #4070a0">&quot;color&quot;</span><span style="color: #666666">:</span> options.notconfig.color, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 83</span>                                 <span style="color: #4070a0">&quot;pointWidth&quot;</span><span style="color: #666666">:</span> options.serverWidth, 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 84</span>                                 <span style="color: #60a0b0; font-style: italic">// &quot;enableMouseTracking&quot;: false, </span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 85</span>                                 showInLegend<span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>};
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 86</span>             <span style="color: #007020; font-weight: bold">var</span> notconfigLength <span style="color: #666666">=</span> series[i].data.length;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 87</span>             chartdata.push(notconfigHash);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 88</span>           }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 89</span>         }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 90</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 91</span>         <span style="color: #60a0b0; font-style: italic">// =====================================================================================================</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 92</span>         <span style="color: #60a0b0; font-style: italic">// This is all to create percetages of uptime/downtime percents for each service/host</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 93</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 94</span>         <span style="color: #60a0b0; font-style: italic">// Created array of default objects</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 95</span>         <span style="color: #007020; font-weight: bold">for</span> (<span style="color: #007020; font-weight: bold">var</span> i <span style="color: #666666">=</span> <span style="color: #40a070">0</span>; i <span style="color: #666666">&lt;</span> numberofrows; i<span style="color: #666666">++</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 96</span>           allPercentages.push({
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 97</span>             <span style="color: #4070a0">&#39;name&#39;</span><span style="color: #666666">:</span><span style="color: #4070a0">&#39;No Data&#39;</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 98</span>             <span style="color: #4070a0">&#39;has_data&#39;</span><span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px"> 99</span>             <span style="color: #4070a0">&#39;uptime_percent&#39;</span><span style="color: #666666">:</span><span style="color: #40a070">0</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">100</span>             <span style="color: #4070a0">&#39;is_available&#39;</span><span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">101</span>             <span style="color: #4070a0">&#39;mainttime_percent&#39;</span><span style="color: #666666">:</span><span style="color: #40a070">0</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">102</span>             <span style="color: #4070a0">&#39;in_maintinence&#39;</span><span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">103</span>           });
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">104</span>         };
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">105</span>         
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">106</span>         <span style="color: #60a0b0; font-style: italic">// Creating a new endtime for servers with unmapped time</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">107</span>         <span style="color: #007020; font-weight: bold">for</span> (<span style="color: #007020; font-weight: bold">var</span> dl <span style="color: #666666">=</span> <span style="color: #40a070">0</span>; dl <span style="color: #666666">&lt;</span> unmappedDataLength; dl<span style="color: #666666">++</span>) { 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">108</span>           <span style="color: #007020; font-weight: bold">var</span> xpos <span style="color: #666666">=</span> unmappedHash.data[dl].x;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">109</span>           new_end_time[xpos] <span style="color: #666666">=</span> unmappedHash.data[dl].low;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">110</span>         }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">111</span>         
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">112</span>         <span style="color: #60a0b0; font-style: italic">// This loop could be wholely unnessicary depending if we do nothing with &#39;No Data&#39; series</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">113</span>         <span style="color: #007020; font-weight: bold">for</span> (<span style="color: #007020; font-weight: bold">var</span> dl <span style="color: #666666">=</span> <span style="color: #40a070">0</span>; dl <span style="color: #666666">&lt;</span> notconfigLength; dl<span style="color: #666666">++</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">114</span>           <span style="color: #007020; font-weight: bold">var</span> xpos <span style="color: #666666">=</span> notconfigHash.data[dl].x;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">115</span>           allPercentages[xpos].name <span style="color: #666666">=</span> notconfigHash.data[dl].name;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">116</span>           allPercentages[xpos].has_data <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">false</span>; <span style="color: #60a0b0; font-style: italic">// Default value, to skip when looping for top 3</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">117</span>         }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">118</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">119</span>         <span style="color: #007020; font-weight: bold">for</span> (<span style="color: #007020; font-weight: bold">var</span> dl <span style="color: #666666">=</span> <span style="color: #40a070">0</span>; dl <span style="color: #666666">&lt;</span> upDataLength; dl<span style="color: #666666">++</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">120</span>           <span style="color: #007020; font-weight: bold">var</span> xpos <span style="color: #666666">=</span> upHash.data[dl].x;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">121</span>           allPercentages[xpos].name <span style="color: #666666">=</span> upHash.data[dl].name;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">122</span>           totalUpTime[xpos] <span style="color: #666666">+=</span> (upHash.data[dl].high <span style="color: #666666">-</span> upHash.data[dl].low); <span style="color: #60a0b0; font-style: italic">// Add total milliseconds in data point to current totalUpTime xpos index value</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">123</span>           <span style="color: #007020; font-weight: bold">var</span> compare_uptime <span style="color: #666666">=</span> $filter(<span style="color: #4070a0">&#39;number&#39;</span>)( (upHash.data[dl].high <span style="color: #666666">/</span> <span style="color: #40a070">10000</span> ), <span style="color: #40a070">0</span>); <span style="color: #60a0b0; font-style: italic">// chopping off the &#39;seconds&#39; of the epoch to compare with the new end time</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">124</span>           <span style="color: #007020; font-weight: bold">var</span> compare_endtime <span style="color: #666666">=</span> $filter(<span style="color: #4070a0">&#39;number&#39;</span>)((new_end_time[xpos] <span style="color: #666666">/</span> <span style="color: #40a070">10000</span> ), <span style="color: #40a070">0</span>); <span style="color: #60a0b0; font-style: italic">// chopping off the &#39;seconds&#39; to compare with the final high point</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">125</span>           allPercentages[xpos].is_available <span style="color: #666666">=</span> (compare_uptime <span style="color: #666666">==</span> compare_endtime) <span style="color: #666666">?</span> <span style="color: #007020; font-weight: bold">true</span> <span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">false</span>; <span style="color: #60a0b0; font-style: italic">// Check if the endtime matches the final time in final xpos range point</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">126</span>           allPercentages[xpos].has_data <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">true</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">127</span>         }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">128</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">129</span>         <span style="color: #60a0b0; font-style: italic">// A complete run for Unavailabile has to be done as well, incase there is a 100% unavailable server, the uptime function above would comepltely miss it</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">130</span>         <span style="color: #007020; font-weight: bold">for</span> (<span style="color: #007020; font-weight: bold">var</span> dl <span style="color: #666666">=</span> <span style="color: #40a070">0</span>; dl <span style="color: #666666">&lt;</span> downDataLength; dl<span style="color: #666666">++</span>) { 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">131</span>           <span style="color: #007020; font-weight: bold">var</span> xpos <span style="color: #666666">=</span> downHash.data[dl].x;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">132</span>           allPercentages[xpos].name <span style="color: #666666">=</span> downHash.data[dl].name;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">133</span>           totalDownTime[xpos] <span style="color: #666666">+=</span> (downHash.data[dl].high <span style="color: #666666">-</span> downHash.data[dl].low);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">134</span>           allPercentages[xpos].has_data <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">true</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">135</span>         }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">136</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">137</span>         <span style="color: #60a0b0; font-style: italic">// Maintinence has to be run for its own calculations outside of up/down, since servers can be in maintinence while in either up/down state</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">138</span>         <span style="color: #007020; font-weight: bold">for</span> (<span style="color: #007020; font-weight: bold">var</span> dl <span style="color: #666666">=</span> <span style="color: #40a070">0</span>; dl <span style="color: #666666">&lt;</span> maintDataLength; dl<span style="color: #666666">++</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">139</span>           <span style="color: #007020; font-weight: bold">var</span> xpos <span style="color: #666666">=</span> maintHash.data[dl].x;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">140</span>           allPercentages[xpos].name <span style="color: #666666">=</span> maintHash.data[dl].name;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">141</span>           totalMaintTime[xpos] <span style="color: #666666">+=</span> (maintHash.data[dl].high <span style="color: #666666">-</span> maintHash.data[dl].low);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">142</span>           <span style="color: #007020; font-weight: bold">var</span> mainttime_percent <span style="color: #666666">=</span> (totalMaintTime[xpos] <span style="color: #666666">/</span> (totalUpTime[xpos] <span style="color: #666666">+</span> totalDownTime[xpos])) <span style="color: #666666">*</span> <span style="color: #40a070">100</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">143</span>           allPercentages[xpos].mainttime_percent <span style="color: #666666">=</span> $filter(<span style="color: #4070a0">&#39;number&#39;</span>)(mainttime_percent, <span style="color: #40a070">2</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">144</span>           <span style="color: #007020; font-weight: bold">var</span> compare_mainttime <span style="color: #666666">=</span> $filter(<span style="color: #4070a0">&#39;number&#39;</span>)( (maintHash.data[dl].high <span style="color: #666666">/</span> <span style="color: #40a070">10000</span> ), <span style="color: #40a070">0</span>); 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">145</span>           <span style="color: #007020; font-weight: bold">var</span> compare_endtime <span style="color: #666666">=</span> $filter(<span style="color: #4070a0">&#39;number&#39;</span>)((new_end_time[xpos] <span style="color: #666666">/</span> <span style="color: #40a070">10000</span> ), <span style="color: #40a070">0</span>); 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">146</span>           allPercentages[xpos].in_maintinence <span style="color: #666666">=</span> (compare_mainttime <span style="color: #666666">==</span> compare_endtime) <span style="color: #666666">?</span> <span style="color: #007020; font-weight: bold">true</span> <span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">false</span>; 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">147</span>           allPercentages[xpos].has_data <span style="color: #666666">=</span> <span style="color: #007020; font-weight: bold">true</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">148</span>         }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">149</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">150</span>         <span style="color: #60a0b0; font-style: italic">// Calculate the percentages based on uptime and downtime totals</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">151</span>         <span style="color: #007020; font-weight: bold">for</span> (<span style="color: #007020; font-weight: bold">var</span> i <span style="color: #666666">=</span> <span style="color: #40a070">0</span>; i <span style="color: #666666">&lt;</span> numberofrows; i<span style="color: #666666">++</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">152</span>           <span style="color: #007020; font-weight: bold">var</span> uptime_percent <span style="color: #666666">=</span> (totalUpTime[i] <span style="color: #666666">/</span> (totalUpTime[i] <span style="color: #666666">+</span> totalDownTime[i])) <span style="color: #666666">*</span> <span style="color: #40a070">100</span>; <span style="color: #60a0b0; font-style: italic">// Change the time to a percentage</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">153</span>           <span style="color: #007020; font-weight: bold">var</span> downtime_percent <span style="color: #666666">=</span> (totalDownTime[i] <span style="color: #666666">/</span> (totalUpTime[i] <span style="color: #666666">+</span> totalDownTime[i])) <span style="color: #666666">*</span> <span style="color: #40a070">100</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">154</span>           allPercentages[i].uptime_percent <span style="color: #666666">=</span> $filter(<span style="color: #4070a0">&#39;number&#39;</span>)(uptime_percent, <span style="color: #40a070">2</span>); 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">155</span>           allPercentages[i].downtime_percent <span style="color: #666666">=</span> $filter(<span style="color: #4070a0">&#39;number&#39;</span>)(downtime_percent, <span style="color: #40a070">2</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">156</span>         }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">157</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">158</span>         <span style="color: #007020; font-weight: bold">var</span> count <span style="color: #666666">=</span> <span style="color: #40a070">0</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">159</span>         <span style="color: #007020; font-weight: bold">while</span> ( topThreePercents.length <span style="color: #666666">&lt;</span> <span style="color: #40a070">3</span> ){
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">160</span>           
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">161</span>           <span style="color: #60a0b0; font-style: italic">// Initial check, incase there are less than 3 servers/services,</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">162</span>           <span style="color: #60a0b0; font-style: italic">//  because that index in allPercentages might be undefined</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">163</span>           <span style="color: #007020; font-weight: bold">if</span> ( allPercentages[count] <span style="color: #666666">==</span> <span style="color: #007020; font-weight: bold">undefined</span> ) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">164</span>             topThreePercents.push({
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">165</span>               <span style="color: #4070a0">&#39;name&#39;</span><span style="color: #666666">:</span><span style="color: #4070a0">&#39;No Data&#39;</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">166</span>               <span style="color: #4070a0">&#39;has_data&#39;</span><span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">167</span>               <span style="color: #4070a0">&#39;uptime_percent&#39;</span><span style="color: #666666">:</span><span style="color: #40a070">0</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">168</span>               <span style="color: #4070a0">&#39;is_available&#39;</span><span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">169</span>               <span style="color: #4070a0">&#39;mainttime_percent&#39;</span><span style="color: #666666">:</span><span style="color: #40a070">0</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">170</span>               <span style="color: #4070a0">&#39;in_maintinence&#39;</span><span style="color: #666666">:</span><span style="color: #007020; font-weight: bold">false</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">171</span>             });
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">172</span>             count<span style="color: #666666">++</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">173</span>           } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> ( allPercentages[count].has_data <span style="color: #666666">==</span> <span style="color: #007020; font-weight: bold">true</span> ) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">174</span>             topThreePercents.push(allPercentages[count]);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">175</span>             count<span style="color: #666666">++</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">176</span>           } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> ( allPercentages[count].has_data <span style="color: #666666">==</span> <span style="color: #007020; font-weight: bold">false</span> ) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">177</span>             count<span style="color: #666666">++</span>;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">178</span>           }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">179</span>         }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">180</span>         <span style="color: #007020; font-weight: bold">var</span> result <span style="color: #666666">=</span>  {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">181</span>           <span style="color: #4070a0">&#39;company&#39;</span> <span style="color: #666666">:</span> companyID,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">182</span>           <span style="color: #4070a0">&#39;id&#39;</span><span style="color: #666666">:</span> company.id,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">183</span>           <span style="color: #4070a0">&#39;rows&#39;</span><span style="color: #666666">:</span> (numberofrows),
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">184</span>           <span style="color: #4070a0">&#39;series&#39;</span><span style="color: #666666">:</span> chartdata,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">185</span>           <span style="color: #4070a0">&#39;notconfigLength&#39;</span><span style="color: #666666">:</span>notconfigLength,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">186</span>           <span style="color: #4070a0">&#39;allPercentages&#39;</span><span style="color: #666666">:</span>allPercentages
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">187</span>         };
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">188</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">189</span>         <span style="color: #007020; font-weight: bold">return</span> result;
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">190</span>       },
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">191</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">192</span>       counter<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>(index, param) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">193</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">194</span>         <span style="color: #007020; font-weight: bold">var</span> divID <span style="color: #666666">=</span> <span style="color: #4070a0">&#39;#server_&#39;</span><span style="color: #666666">+</span>index<span style="color: #666666">+</span><span style="color: #4070a0">&#39;_availability&#39;</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">195</span>         <span style="color: #007020; font-weight: bold">var</span> uptime_percent <span style="color: #666666">=</span> param.uptime_percent
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">196</span>         <span style="color: #007020; font-weight: bold">var</span> downtime_percent <span style="color: #666666">=</span> param.downtime_percent
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">197</span>         <span style="color: #007020; font-weight: bold">var</span> is_available <span style="color: #666666">=</span> param.is_available
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">198</span>         <span style="color: #007020; font-weight: bold">var</span> in_maintinence <span style="color: #666666">=</span> param.in_maintinence
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">199</span>         <span style="color: #007020; font-weight: bold">var</span> mainttime_percent <span style="color: #666666">=</span> param.mainttime_percent
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">200</span>         <span style="color: #007020; font-weight: bold">var</span> has_data <span style="color: #666666">=</span> param.has_data
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">201</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">202</span>         <span style="color: #007020; font-weight: bold">if</span> (has_data <span style="color: #666666">===</span> <span style="color: #007020; font-weight: bold">true</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">203</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">204</span>           <span style="color: #60a0b0; font-style: italic">// Indicate the system is &#39;checking&#39; the availability</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">205</span>           $(<span style="color: #4070a0">&#39; .availabilty_indicators .red&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">206</span>             .addClass(<span style="color: #4070a0">&#39;active&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">207</span>             .attr(<span style="color: #4070a0">&#39;data-toggle&#39;</span>, <span style="color: #4070a0">&#39;tootip&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">208</span>             .attr(<span style="color: #4070a0">&#39;data-original-title&#39;</span>, <span style="color: #4070a0">&#39;Checking&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">209</span>             .tooltip(<span style="color: #4070a0">&#39;show&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">210</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">211</span>           $timeout(<span style="color: #007020; font-weight: bold">function</span>() { <span style="color: #60a0b0; font-style: italic">// 10millisec timeout to delay the data loading</span>
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">212</span>             $( divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availability_counter&#39;</span> ).countTo({
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">213</span>               from<span style="color: #666666">:</span> <span style="color: #40a070">0</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">214</span>               to<span style="color: #666666">:</span> uptime_percent,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">215</span>               speed<span style="color: #666666">:</span> <span style="color: #40a070">5000</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">216</span>               refreshInterval<span style="color: #666666">:</span> <span style="color: #40a070">100</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">217</span>               decimals<span style="color: #666666">:</span> <span style="color: #40a070">2</span>,
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">218</span>               onComplete<span style="color: #666666">:</span> <span style="color: #007020; font-weight: bold">function</span>(value) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">219</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">220</span>                 <span style="color: #007020; font-weight: bold">if</span> (uptime_percent <span style="color: #666666">==</span> <span style="color: #40a070">100.00</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">221</span>                   $( divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availability_counter&#39;</span>).html(<span style="color: #4070a0">&#39;100&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">222</span>                 }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">223</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">224</span>                 <span style="color: #007020; font-weight: bold">if</span> (is_available <span style="color: #666666">==</span> <span style="color: #007020; font-weight: bold">true</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">225</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">226</span>                   $(divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availabilty_indicators .red&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">227</span>                    .removeClass(<span style="color: #4070a0">&#39;active&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">228</span>                    .tooltip(<span style="color: #4070a0">&#39;destroy&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">229</span>                   
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">230</span>                   $(divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availabilty_indicators .green&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">231</span>                     .addClass(<span style="color: #4070a0">&#39;active&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">232</span>                     .attr(<span style="color: #4070a0">&#39;data-toggle&#39;</span>, <span style="color: #4070a0">&#39;tootip&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">233</span>                     .attr(<span style="color: #4070a0">&#39;data-original-title&#39;</span>, uptime_percent<span style="color: #666666">+</span><span style="color: #4070a0">&#39;% Available&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">234</span>                     .tooltip(<span style="color: #4070a0">&#39;show&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">235</span>                   
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">236</span>                   $timeout(<span style="color: #007020; font-weight: bold">function</span>() {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">237</span>                     $( divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availabilty_indicators .green&#39;</span>).tooltip(<span style="color: #4070a0">&#39;hide&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">238</span>                   }, <span style="color: #40a070">3000</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">239</span>                 } <span style="color: #007020; font-weight: bold">else</span> <span style="color: #007020; font-weight: bold">if</span> (is_available <span style="color: #666666">!=</span> <span style="color: #007020; font-weight: bold">true</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">240</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">241</span>                   $(divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availabilty_indicators .red&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">242</span>                     .attr(<span style="color: #4070a0">&#39;data-original-title&#39;</span>, downtime_percent<span style="color: #666666">+</span><span style="color: #4070a0">&#39;% Unavailable&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">243</span>                     .tooltip(<span style="color: #4070a0">&#39;show&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">244</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">245</span>                   $timeout(<span style="color: #007020; font-weight: bold">function</span>() {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">246</span>                     $( divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availabilty_indicators .red&#39;</span>).tooltip(<span style="color: #4070a0">&#39;hide&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">247</span>                   }, <span style="color: #40a070">3000</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">248</span>                 }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">249</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">250</span>                 <span style="color: #007020; font-weight: bold">if</span> (in_maintinence <span style="color: #666666">==</span> <span style="color: #007020; font-weight: bold">true</span>) {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">251</span>                   $( divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availabilty_indicators .yellow&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">252</span>                     .addClass(<span style="color: #4070a0">&#39;active&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">253</span>                     .attr(<span style="color: #4070a0">&#39;data-toggle&#39;</span>, <span style="color: #4070a0">&#39;tootip&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">254</span>                     .attr(<span style="color: #4070a0">&#39;data-original-title&#39;</span>, mainttime_percent<span style="color: #666666">+</span><span style="color: #4070a0">&#39;% Maintenance&#39;</span>)
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">255</span>                     .tooltip(<span style="color: #4070a0">&#39;show&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">256</span> 
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">257</span>                   $timeout(<span style="color: #007020; font-weight: bold">function</span>() {
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">258</span>                     $( divID <span style="color: #666666">+</span><span style="color: #4070a0">&#39; .availabilty_indicators .yellow&#39;</span>).tooltip(<span style="color: #4070a0">&#39;hide&#39;</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">259</span>                   }, <span style="color: #40a070">3000</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">260</span>                 };
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">261</span>               }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">262</span>             });
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">263</span>           }, <span style="color: #40a070">10</span>);
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">264</span>         };
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">265</span>       }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">266</span>     }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">267</span>   }
<span style="background-color: #f0f0f0; padding: 0 5px 0 5px">268</span> ])
</pre></div>
